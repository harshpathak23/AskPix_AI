(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1226:(e,t,a)=>{Promise.resolve().then(a.bind(a,25999))},25999:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>et});var s=a(57437),r=a(2265),l=a(87138),i=a(66806),n=a(56315),o=a(81553),c=a(32894),d=a(79428),u=a(68078),m=a(58627),x=a(80539),f=a(69169),h=a(44182),p=a(42493),g=a(19217),v=a(59360),j=a(60926),b=a(38087),w=a(16508),N=a(20530),y=a(24924),S=a(66648),C=a(46505);a(67140);var k=a(75735),Z=a(89733),T=a(86670),E=a(48185);a(62824);var z=a(20859);function A(e){let{text:t}=e,a=t.split(/(\$\$[\s\S]*?\$\$)/g).filter(Boolean);return(0,s.jsx)("div",{className:"text-base leading-relaxed space-y-4",children:a.map((e,t)=>{if(e.startsWith("$$")&&e.endsWith("$$"))return(0,s.jsx)("div",{className:"my-2 overflow-x-auto",children:(0,s.jsx)(z.BlockMath,{math:e.slice(2,-2)})},t);{let a=e.split(/\n+/).filter(Boolean),r=/(\$[\s\S]*?\$)/g;return a.map((e,a)=>{let l=e.split(r).filter(Boolean);return(0,s.jsx)("p",{children:l.map((e,t)=>e.startsWith("$")&&e.endsWith("$")?(0,s.jsx)(z.InlineMath,{math:e.slice(1,-1)},t):(0,s.jsx)("span",{children:e},t))},"".concat(t,"-").concat(a))})}})})}function R(e){let{solution:t}=e,[a,l]=(0,r.useState)(""),[i,n]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{if(l(""),n(!0),t.length<100){l(t),n(!1);return}let e=t.split(/(\s+)/),a=0,s=setInterval(()=>{a<e.length?(l(t=>t+e[a]),a++):(clearInterval(s),n(!1))},20);return()=>clearInterval(s)},[t]),(0,s.jsx)("div",{className:"w-full animate-in fade-in-50 duration-500",children:(0,s.jsxs)(E.Zb,{className:"bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 text-slate-200 border-purple-900/50",children:[(0,s.jsx)(E.Ol,{children:(0,s.jsx)(E.ll,{className:"text-slate-100",children:"Detailed Solution"})}),(0,s.jsxs)(E.aY,{children:[(0,s.jsx)(A,{text:a}),i&&(0,s.jsx)("div",{className:"pt-4 text-muted-foreground animate-pulse",children:"Typing....."})]})]})})}var I=a(87992),P=a(9385),O=a(49354);let _=P.fC,D=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(P.aV,{ref:t,className:(0,O.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});D.displayName=P.aV.displayName;let V=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(P.xz,{ref:t,className:(0,O.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-accent data-[state=active]:text-accent-foreground data-[state=active]:shadow-sm",a),...r})});V.displayName=P.xz.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(P.VY,{ref:t,className:(0,O.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})}).displayName=P.VY.displayName;var F=a(96551);let M=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(F.fC,{ref:t,className:(0,O.cn)("relative flex w-full touch-none select-none items-center",a),...r,children:[(0,s.jsx)(F.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,s.jsx)(F.e6,{className:"absolute h-full bg-primary"})}),(0,s.jsx)(F.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});M.displayName=F.fC.displayName;var B=a(89506),L=a(86763),U=a(69842),$=a(16463),W=a(71885),Y=a(19779);let q=e=>{let{subject:t,setSubject:a,handleStartScanning:r}=e;return(0,s.jsxs)("div",{className:"w-full max-w-sm mx-auto bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 text-slate-200 rounded-2xl shadow-xl p-6 flex flex-col animate-in fade-in-50 duration-500 h-[95vh] min-h-[700px]",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 pt-8 pb-4 flex flex-col items-center",children:[(0,s.jsx)(T.T,{animated:!0,className:"h-[320px] w-[320px] mb-2"}),(0,s.jsx)("p",{className:"text-xs text-slate-400 tracking-wider",children:"Build By Harsh Pathak"})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col justify-center space-y-4",children:[(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-slate-100",children:"Choose a subject"})}),(0,s.jsx)(_,{defaultValue:t,onValueChange:e=>a(e),className:"w-full",children:(0,s.jsxs)(D,{className:"grid w-full grid-cols-3 gap-3 h-auto p-0 bg-transparent",children:[(0,s.jsxs)(V,{value:"Mathematics",className:"flex-col h-16 gap-1 bg-white/5 border-white/10 hover:bg-white/10 shadow-sm rounded-xl transition-all duration-200 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white data-[state=active]:border-transparent",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"font-medium text-xs",children:"Math"})]}),(0,s.jsxs)(V,{value:"Physics",className:"flex-col h-16 gap-1 bg-white/5 border-white/10 hover:bg-white/10 shadow-sm rounded-xl transition-all duration-200 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white data-[state=active]:border-transparent",children:[(0,s.jsx)(n.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"font-medium text-xs",children:"Physics"})]}),(0,s.jsxs)(V,{value:"Chemistry",className:"flex-col h-16 gap-1 bg-white/5 border-white/10 hover:bg-white/10 shadow-sm rounded-xl transition-all duration-200 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white data-[state=active]:border-transparent",children:[(0,s.jsx)(o.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"font-medium text-xs",children:"Chemistry"})]}),(0,s.jsxs)(V,{value:"Biology",className:"flex-col h-16 gap-1 bg-white/5 border-white/10 hover:bg-white/10 shadow-sm rounded-xl transition-all duration-200 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white data-[state=active]:border-transparent",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"font-medium text-xs",children:"Biology"})]}),(0,s.jsxs)(V,{value:"General",className:"col-span-2 flex-col h-16 gap-1 bg-white/5 border-white/10 hover:bg-white/10 shadow-sm rounded-xl transition-all duration-200 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white data-[state=active]:border-transparent",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"font-medium text-xs",children:"General Question"})]})]})})]}),(0,s.jsx)("div",{className:"flex-shrink-0 pt-4 pb-2",children:(0,s.jsxs)(Z.z,{onClick:r,size:"lg",className:"w-full text-lg py-6 animate-pulse-glow",children:[(0,s.jsx)(u.Z,{className:"mr-3 h-6 w-6"}),"Start Scanning"]})})]})},G=e=>{let{hasCameraPermission:t,videoRef:a,canvasRef:r,error:l,flashSupported:i,isFlashOn:n,toggleFlash:o,zoomSupported:c,handleZoomChange:d,handleScan:h}=e;return(0,s.jsx)("div",{className:"w-full h-full flex flex-col items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full h-full overflow-hidden relative flex items-center justify-center bg-black rounded-lg",children:[null===t&&(0,s.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-20 text-white bg-black/50",children:[(0,s.jsx)(u.Z,{className:"h-16 w-16 mb-4 animate-pulse"}),(0,s.jsx)("p",{className:"text-xl font-medium",children:"Initializing Camera..."}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Please allow camera permissions if prompted."})]}),(0,s.jsx)("video",{ref:a,className:(0,O.cn)("w-full h-full object-cover",!0!==t&&"opacity-0"),autoPlay:!0,muted:!0,playsInline:!0}),!0===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-primary/70 shadow-[0_0_20px_5px_hsl(var(--primary))] animate-scan-line pointer-events-none"}),(0,s.jsx)("div",{className:"absolute top-4 right-4 z-10 space-y-3",children:i&&(0,s.jsx)(Z.z,{onClick:o,size:"icon",variant:n?"secondary":"ghost",className:"h-12 w-12 rounded-full backdrop-blur-sm bg-black/20 hover:bg-black/40 text-white",children:(0,s.jsx)(m.Z,{className:(0,O.cn)(n&&"fill-yellow-300 text-yellow-300")})})}),c&&(0,s.jsxs)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 h-1/2 max-h-64 flex flex-col items-center space-y-2",children:[(0,s.jsx)(x.Z,{className:"text-white/80"}),(0,s.jsx)(M,{defaultValue:[1],min:1,max:10,step:.5,onValueChange:d,className:"w-auto",orientation:"vertical"})]})]}),!1===t&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)(I.bZ,{variant:"destructive",className:"w-11/12",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4"}),(0,s.jsx)(I.Cd,{children:"Camera Access Required"}),(0,s.jsx)(I.X,{children:l||"Please allow camera access in your browser to use this feature."})]})}),(0,s.jsx)("canvas",{ref:r,className:"hidden"}),(0,s.jsx)("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-10",children:(0,s.jsx)(Z.z,{onClick:h,size:"icon",className:"h-16 w-16 rounded-full animate-pulse-glow border-4 border-white/50",disabled:!0!==t,children:(0,s.jsx)(f.Z,{className:"h-8 w-8"})})})]})})},H=e=>{let{error:t,capturedImage:a,crop:r,setCrop:l,imgRef:i,onImageLoad:n,handleRetake:o,handleGetSolution:c}=e;return(0,s.jsxs)("div",{className:"w-full h-full flex flex-col items-center p-4 text-slate-200",children:[t&&(0,s.jsxs)(I.bZ,{variant:"destructive",className:"mb-4 w-full bg-gradient-to-br from-rose-500 to-red-900 border-rose-400 text-white",children:[(0,s.jsx)(h.Z,{className:"h-4 w-4"}),(0,s.jsx)(I.Cd,{children:"Error"}),(0,s.jsx)(I.X,{children:t})]}),(0,s.jsxs)("div",{className:"text-center mb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-100",children:"Crop Your Question"}),(0,s.jsx)("p",{className:"text-slate-400",children:"Drag to select the area with the question you want to solve."})]}),(0,s.jsx)("div",{className:"w-full flex-1 bg-black/20 border-slate-700/50 border rounded-lg overflow-hidden relative flex items-center justify-center",children:a&&(0,s.jsx)(C.ZP,{crop:r,onChange:(e,t)=>l(e),aspect:void 0,children:(0,s.jsx)(S.default,{ref:i,src:a,alt:"Captured question to crop",width:1200,height:675,onLoad:n,className:"w-full h-auto max-h-[70vh] object-contain"})})}),(0,s.jsxs)("div",{className:"flex w-full gap-4 mt-4",children:[(0,s.jsxs)(Z.z,{onClick:o,className:"w-full text-lg py-6",children:[(0,s.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Retake"]}),(0,s.jsxs)(Z.z,{onClick:c,className:"w-full text-lg py-6",disabled:!(null==r?void 0:r.width)||!(null==r?void 0:r.height),children:[(0,s.jsx)(g.Z,{className:"mr-2 h-5 w-5"}),"Get Solution"]})]})]})},X=[{text:"Analyzing image content...",icon:(0,s.jsx)(f.Z,{className:"h-5 w-5 text-slate-400"})},{text:"Identifying academic subject...",icon:(0,s.jsx)(d.Z,{className:"h-5 w-5 text-slate-400"})},{text:"Formulating step-by-step solution...",icon:(0,s.jsx)(g.Z,{className:"h-5 w-5 text-slate-400"})},{text:"Formatting final answer...",icon:(0,s.jsx)(v.Z,{className:"h-5 w-5 text-slate-400"})}],Q=e=>{let{croppedImage:t}=e,[a,l]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let e=X.map((e,t)=>setTimeout(()=>{l(t+1)},(t+1)*1200));return()=>{e.forEach(clearTimeout)}},[]),(0,s.jsxs)("div",{className:"w-full space-y-6 animate-in fade-in-50 duration-500 p-4 text-slate-200",children:[(0,s.jsx)("div",{className:"w-full aspect-video bg-black/20 border-slate-700/50 border rounded-lg overflow-hidden relative flex items-center justify-center",children:t&&(0,s.jsx)(S.default,{src:t,alt:"Cropped question",fill:!0,className:"object-contain"})}),(0,s.jsxs)(E.Zb,{className:"bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 text-slate-200 border-purple-900/50",children:[(0,s.jsx)(E.Ol,{children:(0,s.jsxs)(E.ll,{className:"text-slate-100 flex items-center gap-2",children:[(0,s.jsx)(g.Z,{className:"animate-pulse"})," Generating Solution"]})}),(0,s.jsx)(E.aY,{children:(0,s.jsx)("ul",{className:"space-y-4",children:X.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-center gap-4 transition-opacity duration-300",style:{opacity:a>=t?1:.4},children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-slate-800 border border-slate-700 shrink-0",children:a>t?(0,s.jsx)(j.Z,{className:"h-5 w-5 text-green-400"}):a===t?(0,s.jsx)(b.Z,{className:"h-5 w-5 animate-spin text-primary"}):e.icon}),(0,s.jsx)("span",{className:(0,O.cn)("font-medium",a>t?"text-slate-400 line-through":"text-slate-200"),children:e.text})]},t))})})]})]})},J=[{text:"Preparing content for translation...",icon:(0,s.jsx)(g.Z,{className:"h-5 w-5 text-slate-400"})},{text:"Generating solution in new language...",icon:(0,s.jsx)(d.Z,{className:"h-5 w-5 text-slate-400"})},{text:"Formatting final answer...",icon:(0,s.jsx)(v.Z,{className:"h-5 w-5 text-slate-400"})}],K=()=>{let[e,t]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let e=J.map((e,a)=>setTimeout(()=>{t(a+1)},(a+1)*800));return()=>e.forEach(clearTimeout)},[]),(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)(E.Zb,{className:"bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 text-slate-200 border-purple-900/50",children:[(0,s.jsx)(E.Ol,{children:(0,s.jsxs)(E.ll,{className:"text-slate-100 flex items-center gap-2",children:[(0,s.jsx)(b.Z,{className:"animate-spin"})," Translating Solution"]})}),(0,s.jsx)(E.aY,{children:(0,s.jsx)("ul",{className:"space-y-4",children:J.map((t,a)=>(0,s.jsxs)("li",{className:"flex items-center gap-4 transition-opacity duration-300",style:{opacity:e>=a?1:.4},children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-slate-800 border border-slate-700 shrink-0",children:e>a?(0,s.jsx)(j.Z,{className:"h-5 w-5 text-green-400"}):e===a?(0,s.jsx)(b.Z,{className:"h-5 w-5 animate-spin text-primary"}):t.icon}),(0,s.jsx)("span",{className:(0,O.cn)("font-medium",e>a?"text-slate-400 line-through":"text-slate-200"),children:t.text})]},a))})})]})})},ee=e=>{let{user:t,croppedImage:a,identifiedSubject:r,subject:i,error:n,language:o,isTranslating:c,handleLanguageChange:u,solution:m,topic:x,formulas:f,handleStartScanning:j,handleSaveSolution:N,isSaving:y,solutionSaved:C,router:k}=e;return(0,s.jsxs)("div",{className:"w-full space-y-6 animate-in fade-in-50 duration-500 p-4 text-slate-200",children:[(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,s.jsx)(T.T,{className:"h-[220px] w-auto mt-2",animated:!0}),(0,s.jsx)("p",{className:"text-xs text-slate-400 tracking-wider mt-2",children:"Build By Harsh Pathak"})]})}),(0,s.jsx)("div",{className:"w-full aspect-video bg-black/20 border-slate-700/50 border rounded-lg overflow-hidden relative flex items-center justify-center",children:a&&(0,s.jsx)(S.default,{src:a,alt:"Cropped question",fill:!0,className:"object-contain"})}),r&&r!==i&&(0,s.jsxs)(I.bZ,{className:"bg-slate-800/50 border-slate-700 text-slate-200",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsx)(I.Cd,{children:"Subject Correction"}),(0,s.jsxs)(I.X,{children:["You selected ",(0,s.jsx)("strong",{children:i}),", but we detected a ",(0,s.jsx)("strong",{children:r})," question. We've provided the solution for ",r,"."]})]}),n&&(0,s.jsxs)(I.bZ,{variant:"destructive",className:"w-full bg-gradient-to-br from-rose-500 to-red-900 border-rose-400 text-white",children:[(0,s.jsx)(h.Z,{className:"h-4 w-4"}),(0,s.jsx)(I.Cd,{children:"Error"}),(0,s.jsx)(I.X,{children:n})]}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-4",children:[(0,s.jsx)("p",{className:"text-slate-400",children:"Language:"}),(0,s.jsx)(_,{defaultValue:o,onValueChange:e=>u(e),className:"w-auto",children:(0,s.jsxs)(D,{className:"bg-white/5 text-slate-300",children:[(0,s.jsx)(V,{value:"en",disabled:c,className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white",children:"English"}),(0,s.jsx)(V,{value:"hi",disabled:c,className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-cyan-400 data-[state=active]:text-white",children:"Hindi"})]})})]}),c?(0,s.jsx)(K,{}):m?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(R,{solution:m}),f&&(0,s.jsxs)(E.Zb,{className:"bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 text-slate-200 border-purple-900/50",children:[(0,s.jsx)(E.Ol,{children:(0,s.jsxs)(E.ll,{className:"flex items-center gap-2 text-slate-100",children:[(0,s.jsx)(v.Z,{}),"Key Formulas"]})}),(0,s.jsx)(E.aY,{children:(0,s.jsx)(A,{text:f})})]})]}):n?null:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 rounded-xl bg-slate-800 border border-slate-700 shadow-sm min-h-[200px]",children:[(0,s.jsx)(g.Z,{size:48,className:"mb-4 text-primary"}),(0,s.jsx)("h3",{className:"text-xl font-semibold",children:"Processing Error"}),(0,s.jsx)("p",{className:"text-slate-400",children:"Could not generate a solution. Please try scanning again."})]})]}),(0,s.jsxs)("div",{className:"flex w-full gap-4",children:[(0,s.jsxs)(Z.z,{onClick:j,className:"w-full text-base py-6",children:[(0,s.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Scan Another"]}),t?(0,s.jsxs)(Z.z,{onClick:N,disabled:y||C,className:"w-full text-base py-6",children:[y?(0,s.jsx)(b.Z,{className:"animate-spin mr-2 h-5 w-5"}):(0,s.jsx)(w.Z,{className:"mr-2 h-5 w-5"}),y?"Saving...":C?"Saved!":"Save Solution"]}):(0,s.jsx)(Z.z,{asChild:!0,className:"w-full text-base py-6 animate-pulse-glow",children:(0,s.jsxs)(l.default,{href:"/login",children:[(0,s.jsx)(w.Z,{className:"mr-2 h-5 w-5"}),"Login to Save"]})})]})]})};function et(){let[e,t]=(0,r.useState)("welcome"),[a,i]=(0,r.useState)(null),[n,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)("Mathematics"),[x,f]=(0,r.useState)(null),[h,p]=(0,r.useState)("en"),[g,v]=(0,r.useState)(null),[j,w]=(0,r.useState)(null),[S,E]=(0,r.useState)(null),[z,A]=(0,r.useState)(null),[R,I]=(0,r.useState)(!1),[P,_]=(0,r.useState)(),[D,V]=(0,r.useState)(!1),[F,M]=(0,r.useState)(!1),[X,J]=(0,r.useState)(!1),[K,et]=(0,r.useState)(1),{user:ea}=(0,Y.a)(),[es,er]=(0,r.useState)(!1),[el,ei]=(0,r.useState)(!1),[en,eo]=(0,r.useState)(!1),{toast:ec}=(0,L.pm)(),ed=(0,$.useRouter)(),eu=(0,r.useRef)(null),em=(0,r.useRef)(null),ex=(0,r.useRef)(null);(0,r.useEffect)(()=>{let t=eu.current;"scanning"!==e&&(null==t?void 0:t.srcObject)&&(t.srcObject.getTracks().forEach(e=>e.stop()),t.srcObject=null)},[e]);let ef=async()=>{var e;if(t("scanning"),v(null),A(null),V(!1),M(!1),J(!1),et(1),!(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia)){A("Camera access is not supported by your browser."),v(!1);return}let a=null,s=null;for(let e of[{video:{facingMode:"environment",width:{ideal:3840},height:{ideal:2160}}}])try{a=await navigator.mediaDevices.getUserMedia(e),console.log("Successfully got camera stream with constraints:",e);break}catch(t){s=t,console.warn("Failed to get stream with constraints:",e,"Error:",t)}if(!a){console.error("All camera requests failed:",s),v(!1),s instanceof Error&&("NotAllowedError"===s.name||"PermissionDeniedError"===s.name)?A("Camera access was denied. Please enable camera permissions in your browser settings."):A("Could not access the camera. It may be in use, not available, or not supported.");return}let r=eu.current;r&&(r.srcObject=a,r.onloadedmetadata=()=>{v(!0);let[e]=a.getVideoTracks(),t=e.getCapabilities();t.torch&&V(!0),t.zoom&&M(!0)})},eh=async()=>{w(null),E(null),i(null),o(null),d(null),A(null),p("en"),_(void 0),f(null),ei(!1),await ef()},ep=async()=>{await eh()},eg=async()=>{if(!P||!ex.current||!P.width||!P.height){A("Please select an area to crop before getting a solution.");return}t("solving"),A(null);try{let e=await function(e,t){let a=document.createElement("canvas"),s=e.naturalWidth/e.width,r=e.naturalHeight/e.height,l=t.x*s,i=t.y*r,n=t.width*s,o=t.height*r;a.width=Math.floor(n),a.height=Math.floor(o);let c=a.getContext("2d");return c?(c.imageSmoothingQuality="high",c.fillStyle="white",c.fillRect(0,0,a.width,a.height),c.drawImage(e,l,i,n,o,0,0,a.width,a.height),new Promise(e=>{e(a.toDataURL("image/jpeg",.9))})):Promise.reject(Error("Failed to get canvas context"))}(ex.current,P);E(e);let a=await fetch("/api/solve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({photoDataUri:e,language:h,subject:u})}),s=await a.json();if(!a.ok)throw Error(s.error||"An unknown error occurred.");o(s.topic||null),i(s.solution),d(s.formulas||null),f(s.identifiedSubject||u),t("result")}catch(e){console.error("Cropping or solving failed",e),A(e instanceof Error?e.message:"Failed to process the image. Please try again."),t("cropping")}},ev=async e=>{if(!S){A("Cannot change language without a solved question.");return}I(!0),A(null),p(e);let t=x||u;try{let a=await fetch("/api/solve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({photoDataUri:S,language:e,subject:t})}),s=await a.json();if(!a.ok)throw Error(s.error||"An unknown error occurred during translation.");i(s.solution),d(s.formulas||null)}catch(e){console.error("Translation failed",e),A(e instanceof Error?e.message:"Failed to translate the solution.")}finally{I(!1)}},ej=async()=>{var e;if(null===(e=eu.current)||void 0===e?void 0:e.srcObject){let[e]=eu.current.srcObject.getVideoTracks();e&&(await e.applyConstraints({advanced:[{torch:!X}]}),J(!X))}},eb=async e=>{var t;let a=e[0];if(null===(t=eu.current)||void 0===t?void 0:t.srcObject){let[e]=eu.current.srcObject.getVideoTracks(),t=e.getCapabilities();if(t.zoom){let s=t.zoom.min,r=t.zoom.max;await e.applyConstraints({advanced:[{zoom:s+(a-1)/9*(r-s)}]}),et(a)}}},ew=async()=>{if(!ea){ec({title:"Login Required",description:"Please log in to save your solutions.",variant:"destructive"});return}if(!S||!a||!n){ec({title:"Error",description:"No solution to save.",variant:"destructive"});return}er(!0);try{await (0,U.ET)((0,U.hJ)(B.db,"users",ea.uid,"solutions"),{croppedImage:S,topic:n,solution:a,formulas:c,subject:u,identifiedSubject:x||u,language:h,createdAt:(0,U.Bt)()}),ei(!0),ec({title:"Success!",description:"Solution saved to your profile.",action:(0,s.jsx)(W.gD,{altText:"View Profile",onClick:()=>ed.push("/profile"),className:"bg-gradient-to-r from-purple-500 to-cyan-400 text-primary-foreground border-transparent hover:opacity-90",children:"View Profile"})})}catch(t){console.error("Error saving solution to Firestore: ",t);let e="An unexpected error occurred while saving.";if(t instanceof U.WA)switch(t.code){case"permission-denied":e="Permission denied. Please check your Firestore security rules.";break;case"resource-exhausted":case"invalid-argument":e="Image file is too large to save. Please try cropping a smaller area.";break;case"unauthenticated":e="You must be logged in to save solutions."}ec({title:"Save Failed",description:e,variant:"destructive"})}finally{er(!1)}};return(0,s.jsxs)("main",{className:(0,O.cn)("min-h-screen","welcome"===e?"flex flex-col items-center justify-center p-4":"container mx-auto max-w-3xl flex flex-col items-center px-0 pb-0"),children:["welcome"===e&&(0,s.jsx)(q,{subject:u,setSubject:m,handleStartScanning:eh}),"welcome"!==e&&(0,s.jsxs)("div",{className:(0,O.cn)("w-full shadow-sm flex flex-1 flex-col mt-4","bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 rounded-t-xl"),children:["scanning"!==e&&"cropping"!==e&&(0,s.jsxs)("header",{className:"w-full max-w-3xl mx-auto py-4 px-4 flex justify-between items-center text-slate-200",children:[(0,s.jsxs)(l.default,{href:"/",className:"font-bold text-xl text-slate-100 flex items-center gap-2",onClick:()=>"welcome"!==e&&t("welcome"),children:[(0,s.jsx)(T.T,{className:"h-[150px] w-auto aspect-[9/16]"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"AskPix AI"})]}),(0,s.jsx)("div",{children:ea?(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-4",children:[(0,s.jsx)(Z.z,{asChild:!0,size:"sm",children:(0,s.jsxs)(l.default,{href:"/profile",children:[(0,s.jsx)(N.Z,{className:"h-4 w-4 sm:mr-2"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"View Profile"})]})}),(0,s.jsxs)(Z.z,{size:"sm",onClick:()=>{eo(!0),t("welcome"),(0,k.w7)(B.I8).catch(e=>{console.error("Error signing out: ",e),ec({title:"Logout Failed",description:"There was an error signing out.",variant:"destructive"})}).finally(()=>{eo(!1)})},disabled:en,children:[en?(0,s.jsx)(b.Z,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(y.Z,{className:"h-4 w-4 sm:mr-2"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Logout"})]})]}):(0,s.jsx)(Z.z,{asChild:!0,children:(0,s.jsx)(l.default,{href:"/login",children:"Login / Sign Up"})})})]}),"scanning"===e&&(0,s.jsx)(G,{hasCameraPermission:g,videoRef:eu,canvasRef:em,error:z,flashSupported:D,isFlashOn:X,toggleFlash:ej,zoomSupported:F,handleZoomChange:eb,handleScan:()=>{if(eu.current&&em.current){let e=eu.current,a=em.current;a.width=e.videoWidth,a.height=e.videoHeight;let s=a.getContext("2d");s&&(s.drawImage(e,0,0,e.videoWidth,e.videoHeight),w(a.toDataURL("image/png")),E(null),i(null),A(null),p("en"),t("cropping"))}}}),"cropping"===e&&(0,s.jsx)(H,{error:z,capturedImage:j,crop:P,setCrop:_,imgRef:ex,onImageLoad:function(e){let{width:t,height:a}=e.currentTarget;_((0,C._H)((0,C.YG)({unit:"px",width:.9*t},16/9,t,a),t,a))},handleRetake:ep,handleGetSolution:eg}),"solving"===e&&(0,s.jsx)(Q,{croppedImage:S}),"result"===e&&(0,s.jsx)(ee,{user:ea,croppedImage:S,identifiedSubject:x,subject:u,error:z,language:h,isTranslating:R,handleLanguageChange:ev,solution:a,topic:n,formulas:c,handleStartScanning:eh,handleSaveSolution:ew,isSaving:es,solutionSaved:el,router:ed})]})]})}},86670:(e,t,a)=>{"use strict";a.d(t,{T:()=>i});var s=a(57437),r=a(66648),l=a(49354);function i(e){let{className:t,animated:a=!1}=e;return(0,s.jsxs)("div",{className:(0,l.cn)("flex justify-center relative overflow-hidden",t),children:[(0,s.jsx)(r.default,{src:"/logo.png",alt:"AskPix AI Logo",width:320,height:320,priority:!0,className:"object-contain w-full h-full"}),a&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-r from-transparent via-white/20 to-transparent animate-shine"})]})}},87992:(e,t,a)=>{"use strict";a.d(t,{Cd:()=>c,X:()=>d,bZ:()=>o});var s=a(57437),r=a(2265),l=a(13027),i=a(49354);let n=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=r.forwardRef((e,t)=>{let{className:a,variant:r,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:r}),a),...l})});o.displayName="Alert";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})});c.displayName="AlertTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...r})});d.displayName="AlertDescription"},89733:(e,t,a)=>{"use strict";a.d(t,{d:()=>o,z:()=>c});var s=a(57437),r=a(2265),l=a(71538),i=a(13027),n=a(49354);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-gradient-to-r from-purple-600 to-cyan-400 text-primary-foreground transition-all hover:opacity-90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:i,asChild:c=!1,...d}=e,u=c?l.g7:"button";return(0,s.jsx)(u,{className:(0,n.cn)(o({variant:r,size:i,className:a})),ref:t,...d})});c.displayName="Button"},48185:(e,t,a)=>{"use strict";a.d(t,{Ol:()=>n,SZ:()=>c,Zb:()=>i,aY:()=>d,ll:()=>o});var s=a(57437),r=a(2265),l=a(49354);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});i.displayName="Card";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});n.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});o.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},71885:(e,t,a)=>{"use strict";a.d(t,{FN:()=>m,Mi:()=>h,VW:()=>c,_i:()=>d,gD:()=>x,lj:()=>p,sA:()=>f});var s=a(57437),r=a(2265),l=a(59429),i=a(13027),n=a(74732),o=a(49354);let c=l.zt,d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.l_,{ref:t,className:(0,o.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...r})});d.displayName=l.l_.displayName;let u=(0,i.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border-purple-900/50 bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 text-slate-200",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),m=r.forwardRef((e,t)=>{let{className:a,variant:r,...i}=e;return(0,s.jsx)(l.fC,{ref:t,className:(0,o.cn)(u({variant:r}),a),...i})});m.displayName=l.fC.displayName;let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.aU,{ref:t,className:(0,o.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...r})});x.displayName=l.aU.displayName;let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.x8,{ref:t,className:(0,o.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...r,children:(0,s.jsx)(n.Z,{className:"h-4 w-4"})})});f.displayName=l.x8.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.Dx,{ref:t,className:(0,o.cn)("text-sm font-semibold",a),...r})});h.displayName=l.Dx.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.dk,{ref:t,className:(0,o.cn)("text-sm opacity-90",a),...r})});p.displayName=l.dk.displayName},19779:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>o,a:()=>c});var s=a(57437),r=a(2265),l=a(75735),i=a(89506);let n=(0,r.createContext)({user:null,loading:!0});function o(e){let{children:t}=e,[a,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=(0,l.Aj)(i.I8,e=>{o(e),d(!1)});return()=>e()},[]),(0,s.jsx)(n.Provider,{value:{user:a,loading:c},children:t})}let c=()=>(0,r.useContext)(n)},86763:(e,t,a)=>{"use strict";a.d(t,{pm:()=>m});var s=a(2265);let r=0,l=new Map,i=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=n(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(c);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},89506:(e,t,a)=>{"use strict";a.d(t,{I8:()=>o,db:()=>c});var s=a(15236),r=a(75735),l=a(69842),i=a(99854);let n=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)({apiKey:"AIzaSyB4B1dsofXTL2vgcuT3JVhchLFNoPUlzUQ",authDomain:"scansolve-d1nh8.firebaseapp.com",projectId:"scansolve-d1nh8",storageBucket:"scansolve-d1nh8.firebasestorage.app",messagingSenderId:"353214824939",appId:"1:353214824939:web:97b98b0a799fa4726f59ae"}),o=(0,r.v0)(n),c=(0,l.ad)(n);(0,i.cF)(n)},49354:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(44839),r=a(96164);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[237,358,728,639,135,176,143,576,964,130,215,744],()=>t(1226)),_N_E=e.O()}]);